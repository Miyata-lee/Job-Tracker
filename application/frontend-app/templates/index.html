<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>JobTracker - Login/Signup</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root{
      --bg1:#1e1e2e; --bg2:#2d2d44; --txt:#e0e0e0; --muted:#a78bfa;
      --brand:#38bdf8; --accent:#7c3aed;
    }
    *{margin:0;padding:0;box-sizing:border-box}
    html,body{height:100%}
    body{
      font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      color:var(--txt);
      background: radial-gradient(1200px 600px at 50% -10%, rgba(56,189,248,.18), transparent 60%),
                  linear-gradient(135deg,var(--bg1),var(--bg2));
      min-height:100vh; display:flex; flex-direction:column; overflow:hidden;
    }

    /* Background layers */
    .bg{
      position:fixed; inset:0; pointer-events:none; z-index:-1;
    }
    /* subtle grid */
    .bg .grid{
      position:absolute; inset:0; opacity:.10; mix-blend:screen;
      background:
        radial-gradient(circle at 50% -20%, rgba(56,189,248,.20), transparent 55%),
        repeating-linear-gradient(90deg, rgba(124,58,237,.22) 0 1px, transparent 1px 40px),
        repeating-linear-gradient(0deg, rgba(56,189,248,.18) 0 1px, transparent 1px 40px);
      mask-image: radial-gradient(ellipse at 50% 30%, rgba(0,0,0,1), rgba(0,0,0,.2) 60%, rgba(0,0,0,0) 85%);
    }
    /* animated orbs */
    .bg .orb{
      position:absolute; width:520px; height:520px; border-radius:50%;
      filter:blur(60px); opacity:.34;
      background:radial-gradient(circle at 30% 30%, rgba(34,211,238,.85), rgba(124,58,237,.65) 55%, rgba(0,0,0,0) 70%);
      animation:float1 18s ease-in-out infinite;
    }
    .bg .orb.two{
      width:640px; height:640px; left:auto; right:-180px; top:22%;
      background:radial-gradient(circle at 60% 40%, rgba(168,85,247,.8), rgba(59,130,246,.65) 55%, rgba(0,0,0,0) 70%);
      animation:float2 22s ease-in-out infinite;
    }
    .bg .orb.three{
      width:460px; height:460px; left:-160px; bottom:-120px;
      background:radial-gradient(circle at 40% 60%, rgba(59,130,246,.85), rgba(34,197,94,.55) 60%, rgba(0,0,0,0) 75%);
      animation:float3 24s ease-in-out infinite;
    }
    @keyframes float1{0%{transform:translate(-8%, -6%)}50%{transform:translate(6%, 3%)}100%{transform:translate(-8%, -6%)}}
    @keyframes float2{0%{transform:translate(6%, -4%)}50%{transform:translate(-4%, 4%)}100%{transform:translate(6%, -4%)}}
    @keyframes float3{0%{transform:translate(4%, 6%)}50%{transform:translate(-4%, -2%)}100%{transform:translate(4%, 6%)}}

    /* Brand header (matches dashboard) */
    .top{padding:32px 16px 6px;text-align:center; position:relative}
    .brand{
      display:flex;gap:12px;align-items:center;justify-content:center;
      font-size:40px;font-weight:800;color:var(--brand);
      text-shadow:0 8px 32px rgba(56,189,248,.45);
    }
    .sub{margin-top:6px;color:var(--muted);font-size:14px}

    /* Auth card */
    .wrap{flex:1; display:grid; place-items:center; padding:20px; position:relative}
    .card{
      width:100%; max-width:430px;
      background:linear-gradient(180deg, rgba(15,23,42,.90), rgba(16,18,34,.92));
      border:1.5px solid rgba(124,58,237,.45);
      border-radius:16px; padding:24px 22px;
      box-shadow:0 24px 64px rgba(56,189,248,.18), 0 16px 48px rgba(124,58,237,.18);
      animation:rise .35s ease; backdrop-filter: blur(6px);
    }
    @keyframes rise{from{opacity:0;transform:translateY(14px)}to{opacity:1;transform:translateY(0)}}

    .tabs{display:flex;gap:8px;justify-content:center;margin-bottom:14px}
    .pill{
      border:1px solid rgba(56,189,248,.45);
      background:transparent;color:#cdeefe;
      padding:8px 14px;border-radius:999px;font-weight:800;font-size:13px;cursor:pointer;transition:.2s
    }
    .pill.active,.pill:hover{
      background:linear-gradient(135deg,#22d3ee,#38bdf8);
      color:#051223;border-color:#22d3ee; box-shadow:0 10px 26px rgba(34,211,238,.35)
    }

    .title{color:#7c3aed; font-weight:800; text-align:center; font-size:22px;margin-top:2px}
    .subtitle{color:var(--muted); text-align:center; font-size:14px; margin:6px 0 16px}

    .row{display:grid;gap:12px}
    .fg label{display:block;margin-bottom:6px;color:var(--muted);font-size:13px}
    .input{
      width:100%; padding:12px; background:#10162b;
      border:1px solid #7c3aed; border-radius:12px; color:#dbeafe; font-size:14px
    }
    .btn{
      width:100%; padding:12px; border:none; border-radius:12px; cursor:pointer;
      font-weight:800; color:#001018; background:linear-gradient(135deg,#22d3ee,#38bdf8);
      box-shadow:0 14px 36px rgba(56,189,248,.32); transition:.2s; margin-top:4px
    }
    .btn:hover{transform:translateY(-2px)}
    .alt{margin-top:10px;text-align:center;color:var(--muted);font-size:14px}
    .alt a{color:#38bdf8;cursor:pointer;font-weight:800}

    .alert{display:none;padding:10px;border-radius:10px;font-size:14px;margin-bottom:10px}
    .err{background:rgba(239,68,68,.1);border:1px solid #ef4444;color:#fca5a5}
    .ok{background:rgba(34,197,94,.1);border:1px solid #22c55e;color:#86efac}

    .hidden{display:none}
  </style>
</head>
<body>
  <!-- Visual background layers -->
  <div class="bg" aria-hidden="true">
    <div class="grid"></div>
    <div class="orb one" style="left:-120px; top:-80px;"></div>
    <div class="orb two"></div>
    <div class="orb three"></div>
  </div>

  <!-- Brand -->
  <div class="top">
    <div class="brand"><i class="fas fa-briefcase"></i> JobTracker</div>
    <div class="sub">Cloud‑Native Job Application Management System</div>
  </div>

  <div class="wrap">
    <div class="card">
      <!-- Tab pills -->
      <div class="tabs">
        <button id="tabLogin" class="pill active" onclick="showTab('login')"><i class="fas fa-sign-in-alt"></i> Login</button>
        <button id="tabSignup" class="pill" onclick="showTab('signup')"><i class="fas fa-user-plus"></i> Sign Up</button>
      </div>

      <!-- Login -->
      <div id="loginPane">
        <div class="title">Welcome back</div>
        <div class="subtitle">Sign in to track your job journey</div>

        <div id="loginError" class="alert err"></div>
        <div id="loginOk" class="alert ok"></div>

        <form id="loginForm" onsubmit="handleLogin(event)" class="row">
          <div class="fg">
            <label><i class="fas fa-user"></i> Username</label>
            <input id="login_username" class="input" type="text" required placeholder="Enter your username"/>
          </div>
          <div class="fg">
            <label><i class="fas fa-lock"></i> Password</label>
            <input id="login_password" class="input" type="password" required placeholder="Enter your password"/>
          </div>
          <button class="btn" type="submit"><i class="fas fa-arrow-right-to-bracket"></i> Login</button>
        </form>

        <div class="alt">Don’t have an account? <a onclick="showTab('signup')">Create one</a></div>
      </div>

      <!-- Signup -->
      <div id="signupPane" class="hidden">
        <div class="title">Create account</div>
        <div class="subtitle">Join JobTracker today</div>

        <div id="signupError" class="alert err"></div>
        <div id="signupOk" class="alert ok"></div>

        <form id="signupForm" onsubmit="handleSignup(event)" class="row">
          <div class="fg">
            <label><i class="fas fa-user"></i> Username</label>
            <input id="signup_username" class="input" type="text" required placeholder="Choose a username"/>
          </div>
          <div class="fg">
            <label><i class="fas fa-envelope"></i> Email</label>
            <input id="signup_email" class="input" type="email" required placeholder="Enter your email"/>
          </div>
          <div class="fg">
            <label><i class="fas fa-lock"></i> Password</label>
            <input id="signup_password" class="input" type="password" required placeholder="Create a password (min 6 chars)"/>
          </div>
          <div class="fg">
            <label><i class="fas fa-lock"></i> Confirm Password</label>
            <input id="signup_confirm" class="input" type="password" required placeholder="Confirm your password"/>
          </div>
          <button class="btn" type="submit"><i class="fas fa-user-plus"></i> Sign Up</button>
        </form>

        <div class="alt">Already have an account? <a onclick="showTab('login')">Login</a></div>
      </div>
    </div>
  </div>

  <script>
    function showTab(which){
      const loginPane=document.getElementById('loginPane');
      const signupPane=document.getElementById('signupPane');
      const tabLogin=document.getElementById('tabLogin');
      const tabSignup=document.getElementById('tabSignup');
      ['loginError','loginOk','signupError','signupOk'].forEach(id=>{const e=document.getElementById(id); if(e) e.style.display='none';});
      if(which==='login'){
        loginPane.classList.remove('hidden'); signupPane.classList.add('hidden');
        tabLogin.classList.add('active'); tabSignup.classList.remove('active');
        document.getElementById('loginForm').reset();
      }else{
        signupPane.classList.remove('hidden'); loginPane.classList.add('hidden');
        tabSignup.classList.add('active'); tabLogin.classList.remove('active');
        document.getElementById('signupForm').reset();
      }
    }

    async function handleLogin(e){
      e.preventDefault();
      const username=document.getElementById('login_username').value.trim();
      const password=document.getElementById('login_password').value;
      const err=document.getElementById('loginError');
      const ok=document.getElementById('loginOk');
      try{
        const res=await fetch('/api/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username,password})});
        const data=await res.json();
        if(data.success){
          ok.textContent='Login successful! Redirecting...'; ok.style.display='block';
          setTimeout(()=> location.href='/dashboard', 900);
        }else{
          err.textContent=data.message||'Login failed'; err.style.display='block';
        }
      }catch(_){
        err.textContent='Network error. Please try again.'; err.style.display='block';
      }
    }

    async function handleSignup(e){
      e.preventDefault();
      const username=document.getElementById('signup_username').value.trim();
      const email=document.getElementById('signup_email').value.trim();
      const password=document.getElementById('signup_password').value;
      const confirm=document.getElementById('signup_confirm').value;
      const err=document.getElementById('signupError');
      const ok=document.getElementById('signupOk');

      if(password!==confirm){ err.textContent='Passwords do not match'; err.style.display='block'; return; }
      if(password.length<6){ err.textContent='Password must be at least 6 characters'; err.style.display='block'; return; }

      try{
        const res=await fetch('/api/signup',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username,email,password})});
        const data=await res.json();
        if(data.success){
          ok.textContent='Account created! Switching to login...'; ok.style.display='block';
          setTimeout(()=> showTab('login'), 900);
        }else{
          err.textContent=data.message||'Signup failed'; err.style.display='block';
        }
      }catch(_){
        err.textContent='Network error. Please try again.'; err.style.display='block';
      }
    }
  </script>
</body>
</html>
